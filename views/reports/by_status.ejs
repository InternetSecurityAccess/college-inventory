<%- layout('layout') %>

<h2>Отчет по статусу</h2>

<!-- Форма фильтрации для отчета -->
<div class="report-filters">
    <h3>Фильтры</h3>
    <form action="/reports/by-status" method="GET">
        <label for="startDate">Период с:</label>
        <input type="date" id="startDate" name="startDate" value="<%= currentFilters.startDate || '' %>">

        <label for="endDate">по:</label>
        <input type="date" id="endDate" name="endDate" value="<%= currentFilters.endDate || '' %>">
        <button type="submit">Применить</button>
        <a href="/reports/by-status">Сбросить</a>
        <a href="/reports/by-status/export-csv?<%= new URLSearchParams({ startDate: currentFilters.startDate || '', endDate: currentFilters.endDate || '' }).toString() %>">Экспорт в CSV</a>
    </form>
</div>

<% if (!reportData || reportData.length === 0) { %>
    <p>Нет данных для отображения по заданным критериям.</p>
<% } else { %>
    <table>
        <thead>
            <tr>
                <th>Статус</th>
                <th>Количество предметов</th>
            </tr>
        </thead>
        <tbody>
            <% reportData.forEach(row => { %>
                <tr>
                    <td><%= row.status %></td>
                    <td><%= row.total_items %></td>
                </tr>
            <% }) %>
        </tbody>
    </table>
<% } %>